<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Profile</title>
    <th:block th:replace="partials/header :: font"></th:block>
    <th:block th:replace="partials/Navbar :: styles"></th:block>
    <link rel="stylesheet" th:href="@{/css/profile.css}" type="text/css">
    <style>
        .favCard {
            background-color: white;
            border: 2px black solid;
            border-radius: 10px;
        }

        #favorites {
            width: 50%;
            max-height: 50vh;
        }

        h3 {
            text-align: center;
        }
    </style>
</head>
<body>

<nav th:replace="~{partials/Navbar::navbar}"></nav>
<h1>Champion: <span th:text="${user.username}"></span></h1>
<form sec:authorize="isAuthenticated()" th:if="${#authentication.principal.id == user.id}" th:action="@{/profile/{id}/edit(id=${user.id})}" th:method="get">
    <button type="submit">Edit Profile</button>
</form>

<div class="favorites-section">
    <h3>Favorites</h3>
    <th:block th:each="favorite : ${favorites}">
        <div class="favCard">
            <a th:href="@{/brewery/{id}(id = ${favorite.id})}">
                <h4 th:text="${favorite.name}"></h4>
                <p><span th:text="${favorite.city}"></span><span th:text="', ' + ${favorite.state}"></span></p>
            </a>
        </div>
    </th:block>
</div>
<div id = "wishlist" class="wishlist-section">
    <h3>Wishlist</h3>
    <th:block th:each="wishlist : ${wishlists}">
        <div class="favCard">
            <a th:href="@{/brewery/{id}(id = ${wishlist.id})}">
                <h4 th:text="${wishlist.name}"></h4>
                <p><span th:text="${wishlist.city}"></span><span th:text="', ' + ${wishlist.state}"></span></p>
            </a>
            <form th:action="@{/deletewishlist/{id}(id=${wishlist.id})}" th:method="post">
                <button type="submit" th:value="${wishlist.id}">Remove</button>
            </form>
        </div>
    </th:block>
</div>
<th:block th:replace="partials/Navbar :: scripts"></th:block>

<a th:href="@{/profile/{id}/reviews(id=${user.id})}"><button>My Reviews</button></a>
<form sec:authorize="isAuthenticated()" th:if="${(#authentication.principal.id == user.id) && driver == null}" th:action="@{/signup-driver}" th:method="get">

<button>Sign Up to be a Driver!</button>
</form>

<form sec:authorize="isAuthenticated()" th:if="${(#authentication.principal.id == user.id) && driver != null}" th:action="@{/driver/{id}/edit(id=${user.id})}" th:method="get">
    <button type=“submit”>Edit Driver</button>

</form>
<a sec:authorize="isAuthenticated()" th:if="${(#authentication.principal.id != user.id) && (friendCheck == null)}" th:href="@{/addFriend/{id}(id=${user.id})}">
    <button>Add Friend</button>
</a>
<a sec:authorize="isAuthenticated()" th:if="${(#authentication.principal.id != user.id) && (friendCheck != null)}" th:href="@{/deleteFriend/{id}(id=${user.id})}">
    <button>Delete Friend</button>
</a>
</body>
</html>